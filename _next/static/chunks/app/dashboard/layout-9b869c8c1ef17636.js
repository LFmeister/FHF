(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[663],{9409:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});var r=a(2898);let s=(0,r.Z)("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},2549:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});var r=a(2898);let s=(0,r.Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},3270:function(e,t,a){Promise.resolve().then(a.bind(a,2766))},2766:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return DashboardLayout}});var r=a(7437),s=a(2265),n=a(4033),i=a(9409),l=a(2898);let c=(0,l.Z)("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);var o=a(6806),d=a(5546),u=a(471);function DashboardLayout(e){var t,a;let{children:l}=e,[m,h]=(0,s.useState)(null),[x,f]=(0,s.useState)(!0),[g,p]=(0,s.useState)(!1),v=(0,n.useRouter)(),b=(0,n.usePathname)(),y=(null==b?void 0:b.includes("/projects/"))&&"/dashboard/projects"!==b;(0,s.useEffect)(()=>{let checkUser=async()=>{let{user:e,error:t}=await u.I.getCurrentUser();if(t||!e){v.push("/auth/login");return}h(e),f(!1)};checkUser();let{data:{subscription:e}}=u.I.onAuthStateChange(async(e,t)=>{"SIGNED_OUT"!==e&&t?(null==t?void 0:t.user)&&(h(t.user),f(!1)):v.push("/auth/login")});return()=>e.unsubscribe()},[v]);let handleSignOut=async()=>{await u.I.signOut(),v.push("/auth/login")},refreshUser=async()=>{try{let{user:e}=await u.I.getCurrentUser();h(e)}catch(e){console.error("Error refreshing user:",e)}};return x?(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-primary"})}):(0,r.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-primary-50 to-accent-50",children:[(0,r.jsx)("nav",{className:"bg-white shadow-lg border-b border-primary-200",children:(0,r.jsx)("div",{className:"max-w-7xl mx-auto px-2 sm:px-4 lg:px-8",children:(0,r.jsxs)("div",{className:"flex justify-between items-center h-16",children:[(0,r.jsx)("div",{className:"flex items-center min-w-0 flex-1",children:(0,r.jsxs)("div",{className:"flex items-center space-x-2 sm:space-x-3",children:[(0,r.jsx)("div",{className:"w-8 h-8 bg-gradient-to-br from-primary-600 to-primary-700 rounded-lg flex items-center justify-center flex-shrink-0",children:(0,r.jsx)("span",{className:"text-white font-bold text-sm",children:"MM"})}),(0,r.jsx)("h1",{className:"text-lg sm:text-xl font-bold text-primary-800 truncate",children:"Meister Manager"})]})}),(0,r.jsx)("div",{className:"flex items-center space-x-1 sm:space-x-2 lg:space-x-4 flex-shrink-0",children:m&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"text-right hidden sm:block",children:(0,r.jsx)("div",{className:"flex items-center gap-2",children:(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium text-primary-800",children:(null===(t=m.user_metadata)||void 0===t?void 0:t.full_name)||m.email}),(0,r.jsx)("p",{className:"text-xs text-primary-500",children:m.email})]})})}),y&&(0,r.jsxs)(o.z,{variant:"ghost",size:"sm",onClick:()=>{let e=new CustomEvent("toggleProjectSettings");window.dispatchEvent(e)},className:"text-primary-600 hover:text-primary-800 hidden sm:flex",children:[(0,r.jsx)(i.Z,{className:"h-4 w-4 mr-2"}),"Configuraci\xf3n"]}),(0,r.jsx)(o.z,{variant:"ghost",size:"sm",title:"Ajustes de cuenta",onClick:()=>p(!0),children:(0,r.jsx)(i.Z,{className:"h-4 w-4"})}),(0,r.jsxs)(o.z,{variant:"outline",size:"sm",onClick:handleSignOut,className:"flex items-center",children:[(0,r.jsx)(c,{className:"h-4 w-4 sm:mr-2"}),(0,r.jsx)("span",{className:"hidden sm:inline",children:"Cerrar Sesi\xf3n"})]})]})})]})})}),(0,r.jsx)("main",{className:"max-w-7xl mx-auto py-6 sm:px-6 lg:px-8",children:l}),(0,r.jsx)(d.m,{isOpen:g,onClose:()=>p(!1),currentEmail:(null==m?void 0:m.email)||"",currentFullName:(null==m?void 0:null===(a=m.user_metadata)||void 0===a?void 0:a.full_name)||"",onUpdated:refreshUser})]})}},5546:function(e,t,a){"use strict";a.d(t,{m:function(){return AccountSettingsModal}});var r=a(7437),s=a(2265),n=a(2549),i=a(6806),l=a(9310),c=a(471);function AccountSettingsModal(e){let{isOpen:t,onClose:a,currentEmail:o,currentFullName:d,onUpdated:u}=e,[m,h]=(0,s.useState)(d||""),[x,f]=(0,s.useState)(o),[g,p]=(0,s.useState)(""),[v,b]=(0,s.useState)(""),[y,j]=(0,s.useState)(!1),[w,N]=(0,s.useState)(!1),[C,I]=(0,s.useState)(!1),[k,S]=(0,s.useState)(null),[U,E]=(0,s.useState)(null);if(!t)return null;let handleUpdateName=async()=>{if(S(null),E(null),!m.trim()){E("El nombre no puede estar vac\xedo");return}j(!0);let{error:e}=await c.I.updateFullName(m.trim());j(!1),e?E(e.message||"Error al actualizar el nombre"):(S("Nombre actualizado correctamente"),null==u||u())},handleUpdateEmail=async()=>{if(S(null),E(null),!x.trim()||!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(x)){E("Ingresa un email v\xe1lido");return}if(x.trim()===o){E("El nuevo email debe ser diferente al actual");return}N(!0);let{error:e}=await c.I.updateEmail(x.trim());if(N(!1),e){var t,a;(null===(t=e.message)||void 0===t?void 0:t.includes("already registered"))?E("Este email ya est\xe1 registrado por otro usuario"):(null===(a=e.message)||void 0===a?void 0:a.includes("rate limit"))?E("Demasiados intentos. Espera unos minutos antes de intentar de nuevo"):E(e.message||"Error al actualizar el email")}else S("Se ha enviado un email de confirmaci\xf3n. Revisa tu bandeja de entrada y confirma el cambio antes de que tome efecto."),null==u||u()},handleUpdatePassword=async()=>{if(S(null),E(null),g.length<6){E("La contrase\xf1a debe tener al menos 6 caracteres");return}if(g!==v){E("Las contrase\xf1as no coinciden");return}I(!0);let{error:e}=await c.I.updatePassword(g);I(!1),e?E(e.message||"Error al actualizar la contrase\xf1a"):(S("Contrase\xf1a actualizada correctamente"),p(""),b(""))};return(0,r.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60",children:(0,r.jsxs)("div",{className:"relative w-full max-w-2xl bg-white rounded-lg shadow-xl",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between p-4 border-b",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold",children:"Ajustes de Cuenta"}),(0,r.jsx)(i.z,{variant:"ghost",size:"sm",onClick:a,children:(0,r.jsx)(n.Z,{className:"h-4 w-4"})})]}),(0,r.jsxs)("div",{className:"p-6 space-y-6",children:[U&&(0,r.jsx)("div",{className:"p-3 text-sm text-destructive bg-destructive/10 border border-destructive/20 rounded-md",children:U}),k&&(0,r.jsx)("div",{className:"p-3 text-sm text-green-700 bg-green-50 border border-green-200 rounded-md",children:k}),(0,r.jsxs)("section",{children:[(0,r.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Editar nombre"}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)(l.I,{value:m,onChange:e=>h(e.target.value),placeholder:"Tu nombre"}),(0,r.jsx)(i.z,{onClick:handleUpdateName,loading:y,children:"Guardar"})]})]}),(0,r.jsxs)("section",{children:[(0,r.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Cambiar email"}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)(l.I,{value:x,onChange:e=>f(e.target.value),placeholder:"tu@correo.com"}),(0,r.jsx)(i.z,{onClick:handleUpdateEmail,loading:w,children:"Guardar"})]}),(0,r.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:[(0,r.jsx)("strong",{children:"Importante:"})," Se enviar\xe1 un email de confirmaci\xf3n. El cambio no ser\xe1 efectivo hasta que confirmes desde tu correo."]})]}),(0,r.jsxs)("section",{children:[(0,r.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Cambiar contrase\xf1a"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:[(0,r.jsx)(l.I,{type:"password",value:g,onChange:e=>p(e.target.value),placeholder:"Nueva contrase\xf1a"}),(0,r.jsx)(l.I,{type:"password",value:v,onChange:e=>b(e.target.value),placeholder:"Confirmar contrase\xf1a"})]}),(0,r.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"M\xednimo 6 caracteres"}),(0,r.jsx)("div",{className:"mt-2",children:(0,r.jsx)(i.z,{onClick:handleUpdatePassword,loading:C,children:"Actualizar contrase\xf1a"})})]})]})]})})}},6806:function(e,t,a){"use strict";a.d(t,{z:function(){return n}});var r=a(7437),s=a(2265);let cn=function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return t.filter(Boolean).join(" ")},n=(0,s.forwardRef)((e,t)=>{let{className:a,variant:s="primary",size:n="md",loading:i=!1,disabled:l,children:c,...o}=e;return(0,r.jsxs)("button",{className:cn("inline-flex items-center justify-center rounded-lg font-semibold transition-all duration-200 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary-500 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 shadow-sm hover:shadow-md",{primary:"bg-primary-600 text-white hover:bg-primary-700 active:bg-primary-800",secondary:"bg-accent-100 text-primary-800 hover:bg-accent-200 active:bg-accent-300",outline:"border-2 border-primary-300 bg-white text-primary-700 hover:bg-primary-50 hover:border-primary-400 active:bg-primary-100",ghost:"text-primary-700 hover:bg-primary-50 active:bg-primary-100",danger:"bg-red-600 text-white hover:bg-red-700 active:bg-red-800"}[s],{sm:"h-9 px-4 text-sm",md:"h-11 px-6 py-2.5 text-base",lg:"h-12 px-8 text-lg"}[n],a),ref:t,disabled:l||i,...o,children:[i&&(0,r.jsxs)("svg",{className:"mr-2 h-4 w-4 animate-spin",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"m4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),c]})});n.displayName="Button"},9310:function(e,t,a){"use strict";a.d(t,{I:function(){return i}});var r=a(7437),s=a(2265),n=a(7042);let i=(0,s.forwardRef)((e,t)=>{let{className:a,type:s,error:i,...l}=e;return(0,r.jsxs)("div",{className:"w-full",children:[(0,r.jsx)("input",{type:s,className:(0,n.W)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",i&&"border-destructive focus-visible:ring-destructive",a),ref:t,...l}),i&&(0,r.jsx)("p",{className:"mt-1 text-sm text-destructive",children:i})]})});i.displayName="Input"},471:function(e,t,a){"use strict";a.d(t,{I:function(){return n}});var r=a(7823),s=a(2601);let n={getBaseUrl(){let e=(s.env.NEXT_PUBLIC_SITE_URL||"").replace(/\/$/,"");if(e)return e;{let e=window.location.origin.replace(/\/$/,"");return"".concat(e,"/FHF")}},async signUp(e,t,a){let s="".concat(this.getBaseUrl(),"/auth/callback?email=").concat(encodeURIComponent(e)),{data:n,error:i}=await r.O.auth.signUp({email:e,password:t,options:{data:{full_name:a},emailRedirectTo:s}});return{data:n,error:i}},async signIn(e,t){let{data:a,error:s}=await r.O.auth.signInWithPassword({email:e,password:t});return{data:a,error:s}},async signOut(){let{error:e}=await r.O.auth.signOut();return{error:e}},async resetPassword(e){let{data:t,error:a}=await r.O.auth.resetPasswordForEmail(e,{redirectTo:"".concat(this.getBaseUrl(),"/auth/reset-password")});return{data:t,error:a}},async updatePassword(e){let{data:t,error:a}=await r.O.auth.updateUser({password:e});return{data:t,error:a}},async updateFullName(e){let{data:t,error:a}=await r.O.auth.updateUser({data:{full_name:e}});return{data:t,error:a}},async updateEmail(e){let{data:t,error:a}=await r.O.auth.updateUser({email:e});return{data:t,error:a}},async getCurrentUser(){let{data:{user:e},error:t}=await r.O.auth.getUser();return{user:e,error:t}},async isEmailConfirmed(){let{data:{user:e}}=await r.O.auth.getUser();return(null==e?void 0:e.email_confirmed_at)!==null},async resendConfirmation(e){let t="".concat(this.getBaseUrl(),"/auth/callback?email=").concat(encodeURIComponent(e)),{data:a,error:s}=await r.O.auth.resend({type:"signup",email:e,options:{emailRedirectTo:t}});return{data:a,error:s}},async getSession(){let{data:{session:e},error:t}=await r.O.auth.getSession();return{session:e,error:t}},async setSessionFromHash(){let e=window.location.hash;if(!e||e.length<2)return{set:!1,error:null};let t=new URLSearchParams(e.substring(1)),a=t.get("error"),s=t.get("error_description");if(a)return{set:!1,error:{message:"".concat(a,": ").concat(s||"")}};let n=t.get("access_token"),i=t.get("refresh_token");if(!n||!i)return{set:!1,error:null};let{data:l,error:c}=await r.O.auth.setSession({access_token:n,refresh_token:i});if(!c){try{let e=window.location.pathname+window.location.search;window.history.replaceState({},document.title,e)}catch(e){}return{set:!0,session:null==l?void 0:l.session,error:null}}return{set:!1,error:c}},async exchangeCodeForSession(e){let{data:t,error:a}=await r.O.auth.exchangeCodeForSession(e);return{data:t,error:a}},onAuthStateChange:e=>r.O.auth.onAuthStateChange(e)}},7823:function(e,t,a){"use strict";a.d(t,{O:function(){return s}});var r=a(7440);let s=(0,r.eI)("https://skejleilyksauxtrhxac.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNrZWpsZWlseWtzYXV4dHJoeGFjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTcyNDE5NjIsImV4cCI6MjA3MjgxNzk2Mn0.YCF5aeZDZPQpt-2oqjl2qKEG8YoD3CDMvRJjlCmADEA")},4033:function(e,t,a){e.exports=a(94)}},function(e){e.O(0,[218,971,472,744],function(){return e(e.s=3270)}),_N_E=e.O()}]);